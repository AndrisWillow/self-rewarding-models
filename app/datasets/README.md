TODO: Clean up the numbering and generating